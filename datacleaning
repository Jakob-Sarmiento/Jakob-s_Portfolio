import pandas as pd
from google.colab import files

# load file
df = pd.read_csv("vgchartz-2024.csv")

# remove all duplicate rows
df = df.drop_duplicates()

# Replace "NaN numbers with "0"
df[df.select_dtypes(include="number").columns] = df.select_dtypes(include="number").fillna(0)

# Replace NaN in text with "NA"
df[df.select_dtypes(exclude="number").columns] = df.select_dtypes(exclude="number").fillna("NA")

# Fix date columns
df["release_date"] = df["release_date"].fillna("NA").astype(str)
df["last_update"]  = df["last_update"].fillna("NA").astype(str)

#  Save cleaned dataset
df.to_csv("vgchartz-2024-clean.csv", index=False)

# Download
files.download("vgchartz-2024-clean.csv"
